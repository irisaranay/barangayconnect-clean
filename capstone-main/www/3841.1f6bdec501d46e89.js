"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3841],{3841:(y,g,c)=>{c.r(g),c.d(g,{RequestDocumentPage:()=>q});var m=c(467),_=c(2200),a=c(4341),i=c(9420),d=c(3114),e=c(3664),l=c(8728),h=c(8880),P=c(7527),f=c(1815);function C(s,p){if(1&s&&(e.j41(0,"ion-select-option",15),e.EFF(1),e.k0s()),2&s){const t=p.$implicit;e.Y8G("value",t),e.R7$(),e.JRh(t)}}function O(s,p){if(1&s&&(e.j41(0,"ion-select-option",15),e.EFF(1),e.k0s()),2&s){const t=p.$implicit;e.Y8G("value",t),e.R7$(),e.JRh(t)}}function M(s,p){if(1&s){const t=e.RV6();e.j41(0,"div",16)(1,"ion-label",8),e.EFF(2,"Enter your purpose*"),e.k0s(),e.j41(3,"ion-item")(4,"ion-input",17),e.mxI("ngModelChange",function(n){l.eBV(t);const r=e.XpG();return e.DH7(r.customPurpose,n)||(r.customPurpose=n),l.Njj(n)}),e.k0s()()()}if(2&s){const t=e.XpG();e.R7$(4),e.R50("ngModel",t.customPurpose)}}function R(s,p){1&s&&(e.j41(0,"p"),e.EFF(1,"Tap to upload requirement (Camera/Gallery)"),e.k0s())}function D(s,p){if(1&s){const t=e.RV6();e.j41(0,"div")(1,"ion-label",8),e.EFF(2,"Number of Copies*"),e.k0s(),e.j41(3,"ion-item")(4,"input",18),e.mxI("ngModelChange",function(n){l.eBV(t);const r=e.XpG();return e.DH7(r.numberOfCopies,n)||(r.numberOfCopies=n),l.Njj(n)}),e.k0s()(),e.j41(5,"ion-label",8),e.EFF(6,"Requirements*"),e.k0s(),e.j41(7,"div",19),e.bIt("click",function(){l.eBV(t);const n=e.XpG();return l.Njj(n.openPhotoOptions())}),e.nrm(8,"img",20),e.DNE(9,R,2,0,"p",11),e.k0s()()}if(2&s){const t=e.XpG();e.R7$(4),e.R50("ngModel",t.numberOfCopies),e.R7$(4),e.Y8G("src",t.uploadedPhoto||"assets/img/photo-placeholder.png",e.B4B),e.R7$(),e.Y8G("ngIf",!t.uploadedPhoto)}}let q=(()=>{class s{constructor(t,o,n,r,u,E){this.navCtrl=t,this.requestService=o,this.alertCtrl=n,this.actionSheetCtrl=r,this.platform=u,this.registrationService=E,this.documentType="",this.purpose="",this.customPurpose="",this.numberOfCopies=1,this.requirements="",this.photo="",this.uploadedPhoto=null,this.requests=[],this.dateNow="",this.timeNow="",this.documentOptions=["Barangay Clearance","Certificate of Residency","Certificate of Indigency"],this.purposeOptions=["Employment","School Requirement","Financial Assistance","Others"]}ngOnInit(){var t=this;return(0,m.A)(function*(){const o=new Date;t.dateNow=o.toLocaleDateString(),t.timeNow=o.toLocaleTimeString();const n=t.registrationService.getCurrentUser();n&&n.contact?(t.requests=yield t.requestService.getRequestsByContact(n.contact),console.log("\u{1f4c4} My Requests:",t.requests)):console.warn("\u26a0\ufe0f No logged-in user found."),t.syncRequestsInBackground()})()}syncRequestsInBackground(){var t=this;return(0,m.A)(function*(){setTimeout(()=>{t.requestService.syncUnsyncedRequests()},500)})()}onCancel(){this.navCtrl.back()}onContinue(){var t=this;return(0,m.A)(function*(){if("Others"===t.purpose&&!t.customPurpose.trim())return void alert("Please specify your purpose.");if(t.numberOfCopies<1)return void alert("Number of copies must be at least 1.");const o="Others"===t.purpose?t.customPurpose:t.purpose,n=t.registrationService.getCurrentUser();if(!n||!n.contact)return void alert("No logged-in user found.");const r={documentType:t.documentType,purpose:o,copies:t.numberOfCopies,requirements:t.requirements,photo:t.photo,timestamp:(new Date).toISOString(),contact:n.contact,status:"Pending",notes:"",isSynced:0};try{yield t.requestService.addRequest(r),t.requestService.syncUnsyncedRequests(),yield(yield t.alertCtrl.create({header:"Success",message:"Your request has been submitted.",buttons:["OK"]})).present(),t.resetForm()}catch(u){console.error("Request submission failed:",u),alert("Failed to submit request. Please try again.")}})()}openPhotoOptions(){var t=this;return(0,m.A)(function*(){try{const o=yield d.i7.getPhoto({quality:80,allowEditing:!1,resultType:d.LK.DataUrl,source:d.ru.Prompt});t.uploadedPhoto=o.dataUrl||null,t.photo=o.dataUrl||""}catch(o){console.error("Failed to get photo",o)}})()}resetForm(){this.documentType="",this.purpose="",this.customPurpose="",this.numberOfCopies=1,this.requirements="",this.photo="",this.uploadedPhoto=null}static#e=this.\u0275fac=function(o){return new(o||s)(e.rXU(h.q9),e.rXU(P.s),e.rXU(i.hG),e.rXU(i.GD),e.rXU(h.OD),e.rXU(f.f))};static#t=this.\u0275cmp=e.VBU({type:s,selectors:[["app-request-document"]],decls:28,vars:10,consts:[[3,"translucent"],[1,"request-document-content",3,"fullscreen"],[1,"timestamp"],[1,"date-time"],[1,"form-section"],[1,"instruction"],["placeholder","--Please select document--",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"label-muted"],["placeholder","--Please select purpose--",3,"ngModelChange","ngModel"],["class","custom-input",4,"ngIf"],[4,"ngIf"],[1,"btn-group"],["expand","block","fill","outline","color","medium",3,"click"],["expand","block",3,"click"],[3,"value"],[1,"custom-input"],["placeholder","Type your purpose here...",3,"ngModelChange","ngModel"],["type","number","min","1",1,"native-input","custom-number-input",3,"ngModelChange","ngModel"],[1,"upload-box",3,"click"],["alt","Upload",1,"upload-photo",3,"src"]],template:function(o,n){1&o&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Request Document"),e.k0s()()(),e.j41(4,"ion-content",1)(5,"div",2)(6,"p",3),e.EFF(7),e.k0s()(),e.j41(8,"div",4)(9,"h2"),e.EFF(10,"Request Document"),e.k0s(),e.j41(11,"p",5),e.EFF(12,"Please fill out the form below to submit your request."),e.k0s(),e.j41(13,"ion-item")(14,"ion-select",6),e.mxI("ngModelChange",function(u){return e.DH7(n.documentType,u)||(n.documentType=u),u}),e.DNE(15,C,2,2,"ion-select-option",7),e.k0s()(),e.j41(16,"ion-label",8),e.EFF(17,"Purpose*"),e.k0s(),e.j41(18,"ion-item")(19,"ion-select",9),e.mxI("ngModelChange",function(u){return e.DH7(n.purpose,u)||(n.purpose=u),u}),e.DNE(20,O,2,2,"ion-select-option",7),e.k0s()(),e.DNE(21,M,5,1,"div",10)(22,D,10,3,"div",11),e.j41(23,"div",12)(24,"ion-button",13),e.bIt("click",function(){return n.onCancel()}),e.EFF(25,"Cancel"),e.k0s(),e.j41(26,"ion-button",14),e.bIt("click",function(){return n.onContinue()}),e.EFF(27,"Request"),e.k0s()()()()),2&o&&(e.Y8G("translucent",!0),e.R7$(4),e.Y8G("fullscreen",!0),e.R7$(3),e.Lme("",n.dateNow," | ",n.timeNow),e.R7$(7),e.R50("ngModel",n.documentType),e.R7$(),e.Y8G("ngForOf",n.documentOptions),e.R7$(4),e.R50("ngModel",n.purpose),e.R7$(),e.Y8G("ngForOf",n.purposeOptions),e.R7$(),e.Y8G("ngIf","Others"===n.purpose),e.R7$(),e.Y8G("ngIf","Others"!==n.purpose&&""!==n.purpose))},dependencies:[_.MD,_.Sq,_.bT,a.YN,a.me,a.Q0,a.BC,a.VZ,a.vS,i.bv,i.Jm,i.W9,i.eU,i.$w,i.uz,i.he,i.Nm,i.Ip,i.BC,i.ai,i.Je,i.Gw],styles:[".request-document-content[_ngcontent-%COMP%]{padding:16px}.request-document-content[_ngcontent-%COMP%]   .timestamp[_ngcontent-%COMP%]{text-align:right;font-size:14px;color:#888}.request-document-content[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:20px;margin-top:10px}.request-document-content[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .instruction[_ngcontent-%COMP%]{color:gray;font-size:14px;margin-bottom:10px}.request-document-content[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .label-muted[_ngcontent-%COMP%]{margin-top:16px;font-size:14px;color:gray}.request-document-content[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .custom-input[_ngcontent-%COMP%]{margin-top:10px}.request-document-content[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .upload-box[_ngcontent-%COMP%]{margin-top:12px;border:1px dashed #ccc;border-radius:10px;padding:16px;text-align:center}.request-document-content[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .upload-box[_ngcontent-%COMP%]   .upload-photo[_ngcontent-%COMP%]{width:80px;height:80px;object-fit:contain;margin-bottom:8px}.request-document-content[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .btn-group[_ngcontent-%COMP%]{margin-top:20px;display:flex;flex-direction:column;gap:10px}.request-document-content[_ngcontent-%COMP%]   .custom-number-input[_ngcontent-%COMP%]{width:100%;border:none;font-size:16px;padding:10px 0;outline:none}"]})}return s})()}}]);