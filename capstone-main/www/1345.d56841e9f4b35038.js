"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1345],{1345:(E,m,s)=>{s.r(m),s.d(m,{ResidentDashboardPage:()=>T});var c=s(467),g=s(2200),f=s(4341),a=s(6908),e=s(3664),_=s(7134),p=s(1815),h=s(9420);function u(t,r){if(1&t&&(e.j41(0,"ion-row",30)(1,"ion-col",24),e.EFF(2),e.k0s(),e.j41(3,"ion-col",25),e.EFF(4),e.k0s(),e.j41(5,"ion-col",25),e.EFF(6),e.k0s(),e.j41(7,"ion-col",26),e.EFF(8),e.k0s()()),2&t){const n=r.$implicit;e.R7$(2),e.JRh(n.name),e.R7$(2),e.JRh(n.leadTime),e.R7$(2),e.JRh(n.requirements),e.R7$(2),e.JRh(n.fee)}}let T=(()=>{class t{constructor(n,o,i){this.router=n,this.registrationService=o,this.alertController=i,this.currentDate="",this.currentDay="",this.currentTime="",this.user=null,this.documents=[{name:"Barangay Clearance",leadTime:"1 Day",requirements:"Valid ID",fee:"\u20b150"},{name:"Barangay Indigency",leadTime:"1 Day",requirements:"None",fee:"\u20b130"},{name:"Business Permit",leadTime:"2 Days",requirements:"Application Form",fee:"\u20b1100"}]}ngOnInit(){var n=this;return(0,c.A)(function*(){n.updateDateTime(),setInterval(()=>n.updateDateTime(),1e3),yield n.loadUser()})()}updateDateTime(){const n=new Date,o=navigator.language||"en-US";this.currentDate=n.toLocaleDateString(o,{year:"numeric",month:"long",day:"numeric"}),this.currentDay=n.toLocaleDateString(o,{weekday:"long"}),this.currentTime=n.toLocaleTimeString(o)}loadUser(){var n=this;return(0,c.A)(function*(){try{n.user=yield n.registrationService.getCurrentUser()}catch(o){console.error("Failed to load user:",o)}})()}goToNotifications(){this.router.navigate(["/notifications"])}editProfile(){this.router.navigate(["/profile"])}goToRequestDocument(){this.router.navigate(["/request-document"])}goToRequestLog(){this.router.navigate(["/request-log"])}goToReleasedDocuments(){this.router.navigate(["/released-documents"])}logout(){var n=this;return(0,c.A)(function*(){yield(yield n.alertController.create({header:"Confirm Logout",message:"Are you sure you want to logout?",buttons:[{text:"Cancel",role:"cancel"},{text:"Logout",handler:()=>{n.router.navigate(["/login"])}}]})).present()})()}static#e=this.\u0275fac=function(o){return new(o||t)(e.rXU(_.Ix),e.rXU(p.f),e.rXU(h.hG))};static#t=this.\u0275cmp=e.VBU({type:t,selectors:[["app-resident-dashboard"]],decls:69,vars:7,consts:[["contentId","main-content","type","overlay"],[1,"menu-content"],[1,"profile-container"],[1,"profile-pic"],["alt","Profile Picture",3,"src"],[1,"user-name",3,"click"],["name","pencil-outline",1,"edit-icon"],["lines","none"],["button","",3,"click"],["slot","start","name","document-outline"],["slot","start","name","list-outline"],["slot","start","name","hourglass-outline"],["slot","start","name","log-out-outline"],["slot","start"],["slot","end"],["fill","clear","aria-label","Notifications",3,"click"],["name","notifications-outline"],["id","main-content",1,"dashboard-content",3,"fullscreen"],[1,"date-box"],[1,"date-top"],[1,"day"],[1,"time"],[1,"full-date"],[1,"table-header"],["size","4"],["size","3"],["size","2"],["class","table-row",4,"ngFor","ngForOf"],[1,"note"],["name","alert-circle-outline"],[1,"table-row"]],template:function(o,i){1&o&&(e.j41(0,"ion-menu",0)(1,"ion-content",1)(2,"div",2)(3,"ion-avatar",3),e.nrm(4,"img",4),e.k0s(),e.j41(5,"div",5),e.bIt("click",function(){return i.editProfile()}),e.EFF(6),e.nrm(7,"ion-icon",6),e.k0s()(),e.j41(8,"ion-list",7)(9,"ion-item",8),e.bIt("click",function(){return i.goToRequestDocument()}),e.nrm(10,"ion-icon",9),e.j41(11,"ion-label"),e.EFF(12,"Request Document"),e.k0s()(),e.j41(13,"ion-item",8),e.bIt("click",function(){return i.goToRequestLog()}),e.nrm(14,"ion-icon",10),e.j41(15,"ion-label"),e.EFF(16,"Request Log"),e.k0s()(),e.j41(17,"ion-item",8),e.bIt("click",function(){return i.goToReleasedDocuments()}),e.nrm(18,"ion-icon",11),e.j41(19,"ion-label"),e.EFF(20,"Released Documents"),e.k0s()(),e.j41(21,"ion-item",8),e.bIt("click",function(){return i.logout()}),e.nrm(22,"ion-icon",12),e.j41(23,"ion-label"),e.EFF(24,"Log out"),e.k0s()()()()(),e.j41(25,"ion-header")(26,"ion-toolbar")(27,"ion-buttons",13),e.nrm(28,"ion-menu-button"),e.k0s(),e.j41(29,"ion-title"),e.EFF(30,"Resident Dashboard"),e.k0s(),e.j41(31,"ion-buttons",14)(32,"ion-button",15),e.bIt("click",function(){return i.goToNotifications()}),e.nrm(33,"ion-icon",16),e.k0s()()()(),e.j41(34,"ion-content",17)(35,"div",18)(36,"div",19)(37,"span",20),e.EFF(38),e.k0s(),e.j41(39,"span",21),e.EFF(40),e.k0s()(),e.j41(41,"div",22),e.EFF(42),e.k0s()(),e.j41(43,"ion-card")(44,"ion-card-header")(45,"ion-card-title"),e.EFF(46,"Processing of Documents and Lead Times"),e.k0s(),e.j41(47,"ion-card-subtitle"),e.EFF(48,"(Under Normal Circumstances)"),e.k0s()(),e.j41(49,"ion-grid")(50,"ion-row",23)(51,"ion-col",24)(52,"strong"),e.EFF(53,"Documents"),e.k0s()(),e.j41(54,"ion-col",25)(55,"strong"),e.EFF(56,"Lead Times"),e.k0s()(),e.j41(57,"ion-col",25)(58,"strong"),e.EFF(59,"Requirements"),e.k0s()(),e.j41(60,"ion-col",26)(61,"strong"),e.EFF(62,"Fees"),e.k0s()()(),e.DNE(63,u,9,4,"ion-row",27),e.k0s()(),e.j41(64,"p",28),e.nrm(65,"ion-icon",29),e.j41(66,"strong"),e.EFF(67,"NOTES:"),e.k0s(),e.EFF(68," Unclaimed Barangay Indigency are cancelled after 6 months. Fees are updated as of Year 2025 and may change without prior notice. "),e.k0s()()),2&o&&(e.R7$(4),e.Y8G("src",(null==i.user?null:i.user.photo)||"assets/default-avatar.png",e.B4B),e.R7$(2),e.SpI(" ",(null==i.user?null:i.user.firstName)||"Your Name"," "),e.R7$(28),e.Y8G("fullscreen",!0),e.R7$(4),e.JRh(i.currentDay),e.R7$(2),e.JRh(i.currentTime),e.R7$(2),e.JRh(i.currentDate),e.R7$(21),e.Y8G("ngForOf",i.documents))},dependencies:[g.MD,g.Sq,f.YN,a.W9,a.eU,a.BC,a.ai,a.b_,a.ME,a.tN,a.HW,a.lO,a.ln,a.hU,a.iq,a.QW,a.MC,a.Jm,a.oS,a.nf,a.uz,a.he,a.mC],styles:["ion-menu[_ngcontent-%COMP%]{--width: 280px}ion-menu[_ngcontent-%COMP%]::part(backdrop){background-color:#0000004d}.menu-content[_ngcontent-%COMP%]{background-color:#fff;border-radius:16px;margin:20px 12px;padding:20px 10px;box-shadow:0 4px 16px #0000001a;height:100%;display:flex;flex-direction:column;overflow-y:auto}.profile-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin:30px 0 20px}.profile-pic[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:90px;height:90px;border-radius:50%;object-fit:cover;border:2px solid #ccc}.user-name[_ngcontent-%COMP%]{font-weight:600;font-size:16px;margin-top:10px;display:flex;align-items:center;gap:6px;text-align:center}.edit-icon[_ngcontent-%COMP%]{font-size:16px;margin-left:4px}ion-list[_ngcontent-%COMP%]{padding:0 12px}ion-item[_ngcontent-%COMP%]{--padding-start: 16px;--inner-padding-end: 10px;border-radius:12px;margin:5px 0;font-size:15px;--min-height: 48px;align-items:center;--background-focused: #f0f0f0;--background-hover: #f0f0f0}ion-item[_ngcontent-%COMP%]   ion-icon[slot=start][_ngcontent-%COMP%]{font-size:22px;color:#222;min-width:24px;margin-right:8px}ion-label[_ngcontent-%COMP%]{font-size:15px;color:#333}.date-box[_ngcontent-%COMP%]{padding:10px 16px;text-align:right;font-weight:700}.note[_ngcontent-%COMP%]{font-size:13px;margin:15px;color:red;display:flex;align-items:center;gap:4px}.note[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:red;font-size:16px}"]})}return t})()},1815:(E,m,s)=>{s.d(m,{f:()=>h});var c=s(467),g=s(1471),a=s(8728),e=s(3622),_=s(8880),p=s(8492);let h=(()=>{class u{constructor(t,r,n){this.sqlite=t,this.platform=r,this.storage=n,this.dbInstance=null,this.initDatabase()}initDatabase(){var t=this;return(0,c.A)(function*(){try{if(!t.platform.is("hybrid"))return void console.warn("Not running on hybrid platform \u2014 SQLite is not available.");const r=yield t.sqlite.create({name:"barangayconnect.db",location:"default"});t.dbInstance=r,yield r.executeSql("\n        CREATE TABLE IF NOT EXISTS users (\n          id INTEGER PRIMARY KEY AUTOINCREMENT,\n          firstName TEXT,\n          middleName TEXT,\n          lastName TEXT,\n          dob TEXT,\n          gender TEXT,\n          civilStatus TEXT,\n          contact TEXT UNIQUE,\n          purok TEXT,\n          barangay TEXT,\n          city TEXT,\n          province TEXT,\n          postalCode TEXT,\n          password TEXT,\n          photo TEXT,\n          role TEXT\n        )\n      ",[])}catch(r){console.error("SQLite init error:",r)}})()}saveOfflineRegistration(t){var r=this;return(0,c.A)(function*(){if(!r.dbInstance)return void console.error("Database is not initialized");const n=g.SHA256(t.password).toString(),i=[t.firstName,t.middleName,t.lastName,t.dob,t.gender,t.civilStatus,t.contact,t.purok,t.barangay,t.city,t.province,t.postalCode,n,t.photo,t.role||"resident"];console.log("\u{1f4e5} Attempting to insert into SQLite:",i);try{const l=yield r.dbInstance.executeSql("\n      INSERT INTO users (\n        firstName, middleName, lastName, dob, gender, civilStatus, contact, purok,\n        barangay, city, province, postalCode, password, photo, role\n      ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n    ",i);console.log("\u2705 Insert result:",l),1===l.rowsAffected?console.log("\u2705 User inserted successfully."):console.warn("\u26a0\ufe0f Insert did not affect any rows.")}catch(l){console.error("\u274c Insert error:",l.message||l)}})()}getAllRegistrations(){var t=this;return(0,c.A)(function*(){if(!t.dbInstance)return console.warn("getAllRegistrations: Database not available."),[];const r=yield t.dbInstance.executeSql("SELECT * FROM users",[]),n=[];for(let o=0;o<r.rows.length;o++)n.push(r.rows.item(o));return n})()}isDuplicateContact(t){var r=this;return(0,c.A)(function*(){return r.dbInstance?(yield r.dbInstance.executeSql("SELECT * FROM users WHERE contact = ?",[t])).rows.length>0:(console.warn("isDuplicateContact: Database not available."),!1)})()}isDuplicateName(t,r,n){var o=this;return(0,c.A)(function*(){return o.dbInstance?(yield o.dbInstance.executeSql("SELECT * FROM users WHERE lower(firstName) = ? AND lower(middleName) = ? AND lower(lastName) = ?",[t.toLowerCase(),r.toLowerCase(),n.toLowerCase()])).rows.length>0:(console.warn("isDuplicateName: Database not available."),!1)})()}updateUser(t){var r=this;return(0,c.A)(function*(){if(!r.dbInstance)return void console.warn("updateUser: Database not available.");const o=[t.firstName,t.middleName,t.lastName,t.dob,t.gender,t.civilStatus,t.contact,t.purok,t.barangay,t.city,t.province,t.postalCode,t.password,t.photo,t.id];yield r.dbInstance.executeSql("\n      UPDATE users SET\n        firstName = ?, middleName = ?, lastName = ?, dob = ?, gender = ?, civilStatus = ?,\n        contact = ?, purok = ?, barangay = ?, city = ?, province = ?, postalCode = ?,\n        password = ?, photo = ?\n      WHERE id = ?\n    ",o)})()}checkLogin(t,r){var n=this;return(0,c.A)(function*(){const o=g.SHA256(r).toString();if(n.dbInstance)try{const d=yield n.dbInstance.executeSql("SELECT * FROM users WHERE contact = ? AND password = ?",[t,o]);if(d.rows.length>0)return d.rows.item(0)}catch(d){console.error("SQLite checkLogin error:",d)}else console.warn("SQLite not available. Using fallback storage.");const i=yield n.storage.get("secretary"),l=yield n.storage.get("captain");return i&&i.phone===t&&i.password===o?{...i,role:"secretary"}:l&&l.phone===t&&l.password===o?{...l,role:"captain"}:null})()}setCurrentUser(t){this.currentUser=t}getCurrentUser(){return this.currentUser}clearAll(){var t=this;return(0,c.A)(function*(){t.dbInstance?yield t.dbInstance.executeSql("DELETE FROM users",[]):console.warn("clearAll: Database not available.")})()}static#e=this.\u0275fac=function(r){return new(r||u)(a.KVO(e.j),a.KVO(_.OD),a.KVO(p.w))};static#t=this.\u0275prov=a.jDH({token:u,factory:u.\u0275fac,providedIn:"root"})}return u})()}}]);