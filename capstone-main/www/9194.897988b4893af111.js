"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9194],{1815:(J,H,y)=>{y.d(H,{f:()=>$});var c=y(467),A=y(1471),k=y(8728),q=y(3622),X=y(8880),j=y(8492);let $=(()=>{class L{constructor(a,d,h){this.sqlite=a,this.platform=d,this.storage=h,this.dbInstance=null,this.initDatabase()}initDatabase(){var a=this;return(0,c.A)(function*(){try{if(!a.platform.is("hybrid"))return void console.warn("Not running on hybrid platform \u2014 SQLite is not available.");const d=yield a.sqlite.create({name:"barangayconnect.db",location:"default"});a.dbInstance=d,yield d.executeSql("\n        CREATE TABLE IF NOT EXISTS users (\n          id INTEGER PRIMARY KEY AUTOINCREMENT,\n          firstName TEXT,\n          middleName TEXT,\n          lastName TEXT,\n          dob TEXT,\n          gender TEXT,\n          civilStatus TEXT,\n          contact TEXT UNIQUE,\n          purok TEXT,\n          barangay TEXT,\n          city TEXT,\n          province TEXT,\n          postalCode TEXT,\n          password TEXT,\n          photo TEXT,\n          role TEXT\n        )\n      ",[])}catch(d){console.error("SQLite init error:",d)}})()}saveOfflineRegistration(a){var d=this;return(0,c.A)(function*(){if(!d.dbInstance)return void console.error("Database is not initialized");const h=A.SHA256(a.password).toString(),_=[a.firstName,a.middleName,a.lastName,a.dob,a.gender,a.civilStatus,a.contact,a.purok,a.barangay,a.city,a.province,a.postalCode,h,a.photo,a.role||"resident"];console.log("\u{1f4e5} Attempting to insert into SQLite:",_);try{const w=yield d.dbInstance.executeSql("\n      INSERT INTO users (\n        firstName, middleName, lastName, dob, gender, civilStatus, contact, purok,\n        barangay, city, province, postalCode, password, photo, role\n      ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n    ",_);console.log("\u2705 Insert result:",w),1===w.rowsAffected?console.log("\u2705 User inserted successfully."):console.warn("\u26a0\ufe0f Insert did not affect any rows.")}catch(w){console.error("\u274c Insert error:",w.message||w)}})()}getAllRegistrations(){var a=this;return(0,c.A)(function*(){if(!a.dbInstance)return console.warn("getAllRegistrations: Database not available."),[];const d=yield a.dbInstance.executeSql("SELECT * FROM users",[]),h=[];for(let b=0;b<d.rows.length;b++)h.push(d.rows.item(b));return h})()}isDuplicateContact(a){var d=this;return(0,c.A)(function*(){return d.dbInstance?(yield d.dbInstance.executeSql("SELECT * FROM users WHERE contact = ?",[a])).rows.length>0:(console.warn("isDuplicateContact: Database not available."),!1)})()}isDuplicateName(a,d,h){var b=this;return(0,c.A)(function*(){return b.dbInstance?(yield b.dbInstance.executeSql("SELECT * FROM users WHERE lower(firstName) = ? AND lower(middleName) = ? AND lower(lastName) = ?",[a.toLowerCase(),d.toLowerCase(),h.toLowerCase()])).rows.length>0:(console.warn("isDuplicateName: Database not available."),!1)})()}updateUser(a){var d=this;return(0,c.A)(function*(){if(!d.dbInstance)return void console.warn("updateUser: Database not available.");const b=[a.firstName,a.middleName,a.lastName,a.dob,a.gender,a.civilStatus,a.contact,a.purok,a.barangay,a.city,a.province,a.postalCode,a.password,a.photo,a.id];yield d.dbInstance.executeSql("\n      UPDATE users SET\n        firstName = ?, middleName = ?, lastName = ?, dob = ?, gender = ?, civilStatus = ?,\n        contact = ?, purok = ?, barangay = ?, city = ?, province = ?, postalCode = ?,\n        password = ?, photo = ?\n      WHERE id = ?\n    ",b)})()}checkLogin(a,d){var h=this;return(0,c.A)(function*(){const b=A.SHA256(d).toString();if(h.dbInstance)try{const C=yield h.dbInstance.executeSql("SELECT * FROM users WHERE contact = ? AND password = ?",[a,b]);if(C.rows.length>0)return C.rows.item(0)}catch(C){console.error("SQLite checkLogin error:",C)}else console.warn("SQLite not available. Using fallback storage.");const _=yield h.storage.get("secretary"),w=yield h.storage.get("captain");return _&&_.phone===a&&_.password===b?{..._,role:"secretary"}:w&&w.phone===a&&w.password===b?{...w,role:"captain"}:null})()}setCurrentUser(a){this.currentUser=a}getCurrentUser(){return this.currentUser}clearAll(){var a=this;return(0,c.A)(function*(){a.dbInstance?yield a.dbInstance.executeSql("DELETE FROM users",[]):console.warn("clearAll: Database not available.")})()}static#e=this.\u0275fac=function(d){return new(d||L)(k.KVO(q.j),k.KVO(X.OD),k.KVO(j.w))};static#t=this.\u0275prov=k.jDH({token:L,factory:L.\u0275fac,providedIn:"root"})}return L})()},3114:(J,H,y)=>{y.d(H,{i7:()=>ee,LK:()=>G,ru:()=>D});var c=y(467),A=function(i){return i.Unimplemented="UNIMPLEMENTED",i.Unavailable="UNAVAILABLE",i}(A||{});class I extends Error{constructor(e,t,s){super(e),this.message=e,this.code=t,this.data=s}}const q=i=>{const e=i.CapacitorCustomPlatform||null,t=i.Capacitor||{},s=t.Plugins=t.Plugins||{},n=()=>null!==e?e.name:(i=>{var e,t;return i?.androidBridge?"android":null!==(t=null===(e=i?.webkit)||void 0===e?void 0:e.messageHandlers)&&void 0!==t&&t.bridge?"ios":"web"})(i),l=p=>{var m;return null===(m=t.PluginHeaders)||void 0===m?void 0:m.find(W=>W.name===p)},f=new Map;return t.convertFileSrc||(t.convertFileSrc=p=>p),t.getPlatform=n,t.handleError=p=>i.console.error(p),t.isNativePlatform=()=>"web"!==n(),t.isPluginAvailable=p=>{const m=f.get(p);return!(!m?.platforms.has(n())&&!l(p))},t.registerPlugin=(p,m={})=>{const W=f.get(p);if(W)return console.warn(`Capacitor plugin "${p}" already registered. Cannot register plugins twice.`),W.proxy;const S=n(),M=l(p);let T;const te=function(){var g=(0,c.A)(function*(){return!T&&S in m?T=T="function"==typeof m[S]?yield m[S]():m[S]:null!==e&&!T&&"web"in m&&(T=T="function"==typeof m.web?yield m.web():m.web),T});return function(){return g.apply(this,arguments)}}(),B=g=>{let v;const P=(...U)=>{const O=te().then(E=>{const x=((g,v)=>{var P,U;if(!M){if(g)return null===(U=g[v])||void 0===U?void 0:U.bind(g);throw new I(`"${p}" plugin is not implemented on ${S}`,A.Unimplemented)}{const O=M?.methods.find(E=>v===E.name);if(O)return"promise"===O.rtype?E=>t.nativePromise(p,v.toString(),E):(E,x)=>t.nativeCallback(p,v.toString(),E,x);if(g)return null===(P=g[v])||void 0===P?void 0:P.bind(g)}})(E,g);if(x){const N=x(...U);return v=N?.remove,N}throw new I(`"${p}.${g}()" is not implemented on ${S}`,A.Unimplemented)});return"addListener"===g&&(O.remove=(0,c.A)(function*(){return v()})),O};return P.toString=()=>`${g.toString()}() { [capacitor code] }`,Object.defineProperty(P,"name",{value:g,writable:!1,configurable:!1}),P},Q=B("addListener"),z=B("removeListener"),ne=(g,v)=>{const P=Q({eventName:g},v),U=function(){var E=(0,c.A)(function*(){const x=yield P;z({eventName:g,callbackId:x},v)});return function(){return E.apply(this,arguments)}}(),O=new Promise(E=>P.then(()=>E({remove:U})));return O.remove=(0,c.A)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield U()}),O},K=new Proxy({},{get(g,v){switch(v){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return M?ne:Q;case"removeListener":return z;default:return B(v)}}});return s[p]=K,f.set(p,{name:p,proxy:K,platforms:new Set([...Object.keys(m),...M?[S]:[]])}),K},t.Exception=I,t.DEBUG=!!t.DEBUG,t.isLoggingEnabled=!!t.isLoggingEnabled,t},j=(i=>i.Capacitor=q(i))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),$=j.registerPlugin;class L{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){var s=this;let n=!1;this.listeners[e]||(this.listeners[e]=[],n=!0),this.listeners[e].push(t);const o=this.windowListeners[e];o&&!o.registered&&this.addWindowListener(o),n&&this.sendRetainedArgumentsForEvent(e);const l=function(){var f=(0,c.A)(function*(){return s.removeListener(e,t)});return function(){return f.apply(this,arguments)}}();return Promise.resolve({remove:l})}removeAllListeners(){var e=this;return(0,c.A)(function*(){e.listeners={};for(const t in e.windowListeners)e.removeWindowListener(e.windowListeners[t]);e.windowListeners={}})()}notifyListeners(e,t,s){const n=this.listeners[e];if(n)n.forEach(r=>r(t));else if(s){let r=this.retainedEventArguments[e];r||(r=[]),r.push(t),this.retainedEventArguments[e]=r}}hasListeners(e){var t;return!(null===(t=this.listeners[e])||void 0===t||!t.length)}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:s=>{this.notifyListeners(t,s)}}}unimplemented(e="not implemented"){return new j.Exception(e,A.Unimplemented)}unavailable(e="not available"){return new j.Exception(e,A.Unavailable)}removeListener(e,t){var s=this;return(0,c.A)(function*(){const n=s.listeners[e];if(!n)return;const r=n.indexOf(t);s.listeners[e].splice(r,1),s.listeners[e].length||s.removeWindowListener(s.windowListeners[e])})()}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(s=>{this.notifyListeners(e,s)}))}}const a=i=>encodeURIComponent(i).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),d=i=>i.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class h extends L{getCookies(){return(0,c.A)(function*(){const e=document.cookie,t={};return e.split(";").forEach(s=>{if(s.length<=0)return;let[n,r]=s.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");n=d(n).trim(),r=d(r).trim(),t[n]=r}),t})()}setCookie(e){return(0,c.A)(function*(){try{const t=a(e.key),s=a(e.value),n=`; expires=${(e.expires||"").replace("expires=","")}`,r=(e.path||"/").replace("path=",""),o=null!=e.url&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${s||""}${n}; path=${r}; ${o};`}catch(t){return Promise.reject(t)}})()}deleteCookie(e){return(0,c.A)(function*(){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}})()}clearCookies(){return(0,c.A)(function*(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(e){return Promise.reject(e)}})()}clearAllCookies(){var e=this;return(0,c.A)(function*(){try{yield e.clearCookies()}catch(t){return Promise.reject(t)}})()}}$("CapacitorCookies",{web:()=>new h});const _=function(){var i=(0,c.A)(function*(e){return new Promise((t,s)=>{const n=new FileReader;n.onload=()=>{const r=n.result;t(r.indexOf(",")>=0?r.split(",")[1]:r)},n.onerror=r=>s(r),n.readAsDataURL(e)})});return function(t){return i.apply(this,arguments)}}();class Z extends L{request(e){return(0,c.A)(function*(){const t=((i,e={})=>{const t=Object.assign({method:i.method||"GET",headers:i.headers},e),n=((i={})=>{const e=Object.keys(i);return Object.keys(i).map(n=>n.toLocaleLowerCase()).reduce((n,r,o)=>(n[r]=i[e[o]],n),{})})(i.headers)["content-type"]||"";if("string"==typeof i.data)t.body=i.data;else if(n.includes("application/x-www-form-urlencoded")){const r=new URLSearchParams;for(const[o,l]of Object.entries(i.data||{}))r.set(o,l);t.body=r.toString()}else if(n.includes("multipart/form-data")||i.data instanceof FormData){const r=new FormData;if(i.data instanceof FormData)i.data.forEach((l,u)=>{r.append(u,l)});else for(const l of Object.keys(i.data))r.append(l,i.data[l]);t.body=r;const o=new Headers(t.headers);o.delete("content-type"),t.headers=o}else(n.includes("application/json")||"object"==typeof i.data)&&(t.body=JSON.stringify(i.data));return t})(e,e.webFetchExtra),s=((i,e=!0)=>i?Object.entries(i).reduce((s,n)=>{const[r,o]=n;let l,u;return Array.isArray(o)?(u="",o.forEach(f=>{l=e?encodeURIComponent(f):f,u+=`${r}=${l}&`}),u.slice(0,-1)):(l=e?encodeURIComponent(o):o,u=`${r}=${l}`),`${s}&${u}`},"").substr(1):null)(e.params,e.shouldEncodeUrlParams),n=s?`${e.url}?${s}`:e.url,r=yield fetch(n,t),o=r.headers.get("content-type")||"";let u,f,{responseType:l="text"}=r.ok?e:{};switch(o.includes("application/json")&&(l="json"),l){case"arraybuffer":case"blob":f=yield r.blob(),u=yield _(f);break;case"json":u=yield r.json();break;default:u=yield r.text()}const R={};return r.headers.forEach((p,m)=>{R[m]=p}),{data:u,headers:R,status:r.status,url:r.url}})()}get(e){var t=this;return(0,c.A)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"GET"}))})()}post(e){var t=this;return(0,c.A)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"POST"}))})()}put(e){var t=this;return(0,c.A)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"PUT"}))})()}patch(e){var t=this;return(0,c.A)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"PATCH"}))})()}delete(e){var t=this;return(0,c.A)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"DELETE"}))})()}}$("CapacitorHttp",{web:()=>new Z});var D=function(i){return i.Prompt="PROMPT",i.Camera="CAMERA",i.Photos="PHOTOS",i}(D||{}),F=function(i){return i.Rear="REAR",i.Front="FRONT",i}(F||{}),G=function(i){return i.Uri="uri",i.Base64="base64",i.DataUrl="dataUrl",i}(G||{});class V extends L{getPhoto(e){var t=this;return(0,c.A)(function*(){return new Promise(function(){var s=(0,c.A)(function*(n,r){if(e.webUseInput||e.source===D.Photos)t.fileInputExperience(e,n,r);else if(e.source===D.Prompt){let o=document.querySelector("pwa-action-sheet");o||(o=document.createElement("pwa-action-sheet"),document.body.appendChild(o)),o.header=e.promptLabelHeader||"Photo",o.cancelable=!1,o.options=[{title:e.promptLabelPhoto||"From Photos"},{title:e.promptLabelPicture||"Take Picture"}],o.addEventListener("onSelection",function(){var l=(0,c.A)(function*(u){0===u.detail?t.fileInputExperience(e,n,r):t.cameraExperience(e,n,r)});return function(u){return l.apply(this,arguments)}}())}else t.cameraExperience(e,n,r)});return function(n,r){return s.apply(this,arguments)}}())})()}pickImages(e){var t=this;return(0,c.A)(function*(){return new Promise(function(){var s=(0,c.A)(function*(n,r){t.multipleFileInputExperience(n,r)});return function(n,r){return s.apply(this,arguments)}}())})()}cameraExperience(e,t,s){var n=this;return(0,c.A)(function*(){if(customElements.get("pwa-camera-modal")){const r=document.createElement("pwa-camera-modal");r.facingMode=e.direction===F.Front?"user":"environment",document.body.appendChild(r);try{yield r.componentOnReady(),r.addEventListener("onPhoto",function(){var o=(0,c.A)(function*(l){const u=l.detail;null===u?s(new I("User cancelled photos app")):u instanceof Error?s(u):t(yield n._getCameraPhoto(u,e)),r.dismiss(),document.body.removeChild(r)});return function(l){return o.apply(this,arguments)}}()),r.present()}catch{n.fileInputExperience(e,t,s)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),n.fileInputExperience(e,t,s)})()}fileInputExperience(e,t,s){let n=document.querySelector("#_capacitor-camera-input");const r=()=>{var o;null===(o=n.parentNode)||void 0===o||o.removeChild(n)};n||(n=document.createElement("input"),n.id="_capacitor-camera-input",n.type="file",n.hidden=!0,document.body.appendChild(n),n.addEventListener("change",o=>{const l=n.files[0];let u="jpeg";if("image/png"===l.type?u="png":"image/gif"===l.type&&(u="gif"),"dataUrl"===e.resultType||"base64"===e.resultType){const f=new FileReader;f.addEventListener("load",()=>{if("dataUrl"===e.resultType)t({dataUrl:f.result,format:u});else if("base64"===e.resultType){const R=f.result.split(",")[1];t({base64String:R,format:u})}r()}),f.readAsDataURL(l)}else t({webPath:URL.createObjectURL(l),format:u}),r()}),n.addEventListener("cancel",o=>{s(new I("User cancelled photos app")),r()})),n.accept="image/*",n.capture=!0,e.source===D.Photos||e.source===D.Prompt?n.removeAttribute("capture"):e.direction===F.Front?n.capture="user":e.direction===F.Rear&&(n.capture="environment"),n.click()}multipleFileInputExperience(e,t){let s=document.querySelector("#_capacitor-camera-input-multiple");const n=()=>{var r;null===(r=s.parentNode)||void 0===r||r.removeChild(s)};s||(s=document.createElement("input"),s.id="_capacitor-camera-input-multiple",s.type="file",s.hidden=!0,s.multiple=!0,document.body.appendChild(s),s.addEventListener("change",r=>{const o=[];for(let l=0;l<s.files.length;l++){const u=s.files[l];let f="jpeg";"image/png"===u.type?f="png":"image/gif"===u.type&&(f="gif"),o.push({webPath:URL.createObjectURL(u),format:f})}e({photos:o}),n()}),s.addEventListener("cancel",r=>{t(new I("User cancelled photos app")),n()})),s.accept="image/*",s.click()}_getCameraPhoto(e,t){return new Promise((s,n)=>{const r=new FileReader,o=e.type.split("/")[1];"uri"===t.resultType?s({webPath:URL.createObjectURL(e),format:o,saved:!1}):(r.readAsDataURL(e),r.onloadend=()=>{const l=r.result;s("dataUrl"===t.resultType?{dataUrl:l,format:o,saved:!1}:{base64String:l.split(",")[1],format:o,saved:!1})},r.onerror=l=>{n(l)})})}checkPermissions(){var e=this;return(0,c.A)(function*(){if(typeof navigator>"u"||!navigator.permissions)throw e.unavailable("Permissions API not available in this browser");try{return{camera:(yield window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw e.unavailable("Camera permissions are not available in this browser")}})()}requestPermissions(){var e=this;return(0,c.A)(function*(){throw e.unimplemented("Not implemented on web.")})()}pickLimitedLibraryPhotos(){var e=this;return(0,c.A)(function*(){throw e.unavailable("Not implemented on web.")})()}getLimitedLibraryPhotos(){var e=this;return(0,c.A)(function*(){throw e.unavailable("Not implemented on web.")})()}}new V;const ee=$("Camera",{web:()=>new V})}}]);