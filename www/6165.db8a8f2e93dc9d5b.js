"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6165],{6165:(T,R,a)=>{a.r(R),a.d(R,{RequestLogPage:()=>I});var g=a(467),d=a(2200),u=a(4341),i=a(6908),e=a(3664),l=a(8728),p=a(6316),m=a(1815);function h(o,r){if(1&o){const t=e.RV6();e.j41(0,"ion-button",17),e.bIt("click",function(){l.eBV(t);const n=e.XpG().$implicit,c=e.XpG();return l.Njj(c.cancelRequest(n))}),e.EFF(1," Cancel Request "),e.k0s()}}function P(o,r){if(1&o){const t=e.RV6();e.j41(0,"ion-button",18),e.bIt("click",function(){l.eBV(t);const n=e.XpG().$implicit,c=e.XpG();return l.Njj(c.viewDetails(n))}),e.EFF(1," View Details "),e.k0s()}}function q(o,r){if(1&o){const t=e.RV6();e.j41(0,"ion-button",19),e.bIt("click",function(){l.eBV(t);const n=e.XpG().$implicit,c=e.XpG();return l.Njj(c.deleteRequest(n))}),e.EFF(1," Delete "),e.k0s()}}function F(o,r){if(1&o&&(e.j41(0,"ion-row")(1,"ion-col",7),e.EFF(2),e.k0s(),e.j41(3,"ion-col",8),e.EFF(4),e.k0s(),e.j41(5,"ion-col",8),e.EFF(6),e.k0s(),e.j41(7,"ion-col",9)(8,"ion-text",13),e.EFF(9),e.k0s()(),e.j41(10,"ion-col",8),e.DNE(11,h,2,0,"ion-button",14)(12,P,2,0,"ion-button",15)(13,q,2,0,"ion-button",16),e.k0s()()),2&o){const t=r.$implicit,s=r.index,n=e.XpG();e.R7$(2),e.JRh(s+1+(n.currentPage-1)*n.itemsPerPage),e.R7$(2),e.JRh(t.documentType),e.R7$(2),e.JRh(t.timestamp),e.R7$(2),e.Y8G("color",n.getStatusColor(t.status)),e.R7$(),e.SpI(" ",t.status," "),e.R7$(2),e.Y8G("ngIf","Pending"===t.status),e.R7$(),e.Y8G("ngIf","Pending"!==t.status),e.R7$(),e.Y8G("ngIf","Cancelled"===t.status)}}function f(o,r){if(1&o){const t=e.RV6();e.j41(0,"ion-row",20)(1,"ion-button",21),e.bIt("click",function(){l.eBV(t);const n=e.XpG();return l.Njj(n.prevPage())}),e.EFF(2,"Prev"),e.k0s(),e.j41(3,"span"),e.EFF(4),e.k0s(),e.j41(5,"ion-button",21),e.bIt("click",function(){l.eBV(t);const n=e.XpG();return l.Njj(n.nextPage())}),e.EFF(6,"Next"),e.k0s()()}if(2&o){const t=e.XpG();e.R7$(),e.Y8G("disabled",1===t.currentPage),e.R7$(3),e.Lme("Page ",t.currentPage," of ",t.totalPages),e.R7$(),e.Y8G("disabled",t.currentPage===t.totalPages)}}function E(o,r){if(1&o&&(e.j41(0,"p")(1,"strong"),e.EFF(2,"Remarks:"),e.k0s(),e.EFF(3),e.k0s()),2&o){const t=e.XpG(2);e.R7$(3),e.SpI(" ",(null==t.selectedRequest?null:t.selectedRequest.notes)||"No remarks"," ")}}function k(o,r){if(1&o&&(e.j41(0,"div")(1,"strong"),e.EFF(2,"Photo:"),e.k0s(),e.nrm(3,"img",25),e.k0s()),2&o){const t=e.XpG(2);e.R7$(3),e.Y8G("src",t.selectedRequest.photo,e.B4B)}}function j(o,r){if(1&o){const t=e.RV6();e.j41(0,"ion-modal")(1,"ion-header")(2,"ion-toolbar")(3,"ion-title"),e.EFF(4,"Request Details"),e.k0s(),e.j41(5,"ion-buttons",22)(6,"ion-button",23),e.bIt("click",function(){l.eBV(t);const n=e.XpG();return l.Njj(n.closeModal())}),e.EFF(7,"Close"),e.k0s()()()(),e.j41(8,"ion-content",24)(9,"ion-card")(10,"ion-card-header")(11,"ion-card-title"),e.EFF(12),e.k0s(),e.j41(13,"ion-card-subtitle"),e.EFF(14),e.k0s()(),e.j41(15,"ion-card-content")(16,"p")(17,"strong"),e.EFF(18,"Purpose:"),e.k0s(),e.EFF(19),e.k0s(),e.j41(20,"p")(21,"strong"),e.EFF(22,"Copies:"),e.k0s(),e.EFF(23),e.k0s(),e.j41(24,"p")(25,"strong"),e.EFF(26,"Requested On:"),e.k0s(),e.EFF(27),e.k0s(),e.DNE(28,E,4,1,"p",12)(29,k,4,1,"div",12),e.k0s()()()()}if(2&o){const t=e.XpG();e.R7$(12),e.JRh(null==t.selectedRequest?null:t.selectedRequest.documentType),e.R7$(2),e.JRh(null==t.selectedRequest?null:t.selectedRequest.status),e.R7$(5),e.SpI(" ",null==t.selectedRequest?null:t.selectedRequest.purpose),e.R7$(4),e.SpI(" ",null==t.selectedRequest?null:t.selectedRequest.copies),e.R7$(4),e.SpI(" ",null==t.selectedRequest?null:t.selectedRequest.timestamp),e.R7$(),e.Y8G("ngIf","Rejected"===(null==t.selectedRequest?null:t.selectedRequest.status)),e.R7$(),e.Y8G("ngIf",null==t.selectedRequest?null:t.selectedRequest.photo)}}let I=(()=>{class o{constructor(t,s){this.documentRequestService=t,this.registrationService=s,this.itemsPerPage=5,this.currentPage=1,this.totalPages=1,this.searchTerm="",this.requests=[],this.paginatedRequests=[],this.selectedRequest=null,this.showModal=!1}ngOnInit(){this.loadRequests()}ionViewWillEnter(){var t=this;return(0,g.A)(function*(){yield t.loadRequests()})()}loadRequests(){var t=this;return(0,g.A)(function*(){const s=t.registrationService.getCurrentUser();s&&s.contact?(t.requests=yield t.documentRequestService.getRequestsByContact(s.contact),t.filterRequests()):t.requests=[]})()}filterRequests(){const t=this.requests.filter(s=>s.documentType.toLowerCase().includes(this.searchTerm.toLowerCase())||s.purpose.toLowerCase().includes(this.searchTerm.toLowerCase()));this.totalPages=Math.ceil(t.length/this.itemsPerPage)||1,this.currentPage=1,this.paginateRequests(t)}paginateRequests(t=this.requests){const s=(this.currentPage-1)*this.itemsPerPage;this.paginatedRequests=t.slice(s,s+this.itemsPerPage)}nextPage(){this.currentPage<this.totalPages&&(this.currentPage++,this.paginateRequests())}prevPage(){this.currentPage>1&&(this.currentPage--,this.paginateRequests())}viewDetails(t){this.selectedRequest=t,this.showModal=!0}closeModal(){this.showModal=!1}cancelRequest(t){var s=this;return(0,g.A)(function*(){yield s.documentRequestService.cancelRequestById(t.id),s.loadRequests()})()}deleteRequest(t){var s=this;return(0,g.A)(function*(){yield s.documentRequestService.deleteRequestById(t.id),s.loadRequests()})()}getStatusColor(t){switch(t){case"Pending":return"danger";case"Pending-Incomplete":return"success";case"For Pickup":return"dark";case"Cancelled":return"warning";default:return"medium"}}static#e=this.\u0275fac=function(s){return new(s||o)(e.rXU(p.s),e.rXU(m.f))};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["app-request-log"]],decls:32,vars:10,consts:[[3,"translucent"],[1,"ion-padding",3,"fullscreen"],[1,"table-controls"],[3,"ngModelChange","change","ngModel"],[3,"value"],["type","text","placeholder","Search...",3,"ngModelChange","input","ngModel"],[1,"table-header"],["size","1"],["size","3"],["size","2"],[4,"ngFor","ngForOf"],["class","pagination-controls",4,"ngIf"],[4,"ngIf"],[3,"color"],["color","danger","size","small",3,"click",4,"ngIf"],["color","primary","size","small",3,"click",4,"ngIf"],["color","medium","size","small",3,"click",4,"ngIf"],["color","danger","size","small",3,"click"],["color","primary","size","small",3,"click"],["color","medium","size","small",3,"click"],[1,"pagination-controls"],["size","small",3,"click","disabled"],["slot","end"],[3,"click"],[1,"ion-padding"],[2,"width","100%","margin-top","10px",3,"src"]],template:function(s,n){1&s&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Request Log"),e.k0s()()(),e.j41(4,"ion-content",1)(5,"div",2)(6,"label"),e.EFF(7," Show "),e.j41(8,"select",3),e.mxI("ngModelChange",function(_){return e.DH7(n.itemsPerPage,_)||(n.itemsPerPage=_),_}),e.bIt("change",function(){return n.paginateRequests()}),e.j41(9,"option",4),e.EFF(10,"5"),e.k0s(),e.j41(11,"option",4),e.EFF(12,"10"),e.k0s(),e.j41(13,"option",4),e.EFF(14,"25"),e.k0s()(),e.EFF(15," entries "),e.k0s(),e.j41(16,"input",5),e.mxI("ngModelChange",function(_){return e.DH7(n.searchTerm,_)||(n.searchTerm=_),_}),e.bIt("input",function(){return n.filterRequests()}),e.k0s()(),e.j41(17,"ion-grid")(18,"ion-row",6)(19,"ion-col",7),e.EFF(20,"#"),e.k0s(),e.j41(21,"ion-col",8),e.EFF(22,"Document"),e.k0s(),e.j41(23,"ion-col",8),e.EFF(24,"Date Requested"),e.k0s(),e.j41(25,"ion-col",9),e.EFF(26,"Status"),e.k0s(),e.j41(27,"ion-col",8),e.EFF(28,"Action"),e.k0s()(),e.DNE(29,F,14,8,"ion-row",10),e.k0s(),e.DNE(30,f,7,4,"ion-row",11),e.k0s(),e.DNE(31,j,30,7,"ion-modal",12)),2&s&&(e.Y8G("translucent",!0),e.R7$(4),e.Y8G("fullscreen",!0),e.R7$(4),e.R50("ngModel",n.itemsPerPage),e.R7$(),e.Y8G("value",5),e.R7$(2),e.Y8G("value",10),e.R7$(2),e.Y8G("value",25),e.R7$(3),e.R50("ngModel",n.searchTerm),e.R7$(13),e.Y8G("ngForOf",n.paginatedRequests),e.R7$(),e.Y8G("ngIf",n.totalPages>1),e.R7$(),e.Y8G("ngIf",n.showModal))},dependencies:[d.MD,d.Sq,d.bT,u.YN,u.xH,u.y7,u.me,u.wz,u.BC,u.vS,i.W9,i.eU,i.BC,i.ai,i.lO,i.ln,i.hU,i.IO,i.Jm,i.Sb,i.b_,i.ME,i.tN,i.HW,i.I9,i.QW],encapsulation:2})}return o})()}}]);