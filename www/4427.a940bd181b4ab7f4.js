"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4427],{4427:(S,P,l)=>{l.r(P),l.d(P,{RegistrationPage:()=>v});var d=l(467),s=l(9420),h=l(2200),p=l(4341),f=l(7691),e=l(3664),m=l(8728),C=l(1815),b=l(5530);function R(r,g){if(1&r&&(e.j41(0,"ion-note",40),e.EFF(1),e.k0s()),2&r){const t=e.XpG();e.R7$(),e.SpI(" ",t.nameErrors.firstName," ")}}function O(r,g){if(1&r&&(e.j41(0,"ion-note",40),e.EFF(1),e.k0s()),2&r){const t=e.XpG();e.R7$(),e.SpI(" ",t.nameErrors.middleName," ")}}function w(r,g){if(1&r&&(e.j41(0,"ion-note",40),e.EFF(1),e.k0s()),2&r){const t=e.XpG();e.R7$(),e.SpI(" ",t.nameErrors.lastName," ")}}function E(r,g){if(1&r&&(e.j41(0,"ion-text",41)(1,"p",42),e.EFF(2),e.k0s()()),2&r){const t=e.XpG();e.R7$(2),e.SpI("You are ",t.calculatedAge," years old.")}}function k(r,g){1&r&&(e.j41(0,"ion-text",43)(1,"p",42),e.EFF(2,"You must be at least 18 years old to register."),e.k0s()())}function y(r,g){if(1&r&&(e.j41(0,"ion-select-option",44),e.EFF(1),e.k0s()),2&r){const t=g.$implicit;e.Y8G("value",t),e.R7$(),e.SpI(" ",t," ")}}function I(r,g){if(1&r){const t=e.RV6();e.j41(0,"ion-icon",45),e.bIt("click",function(){m.eBV(t);const n=e.XpG();return m.Njj(n.togglePasswordVisibility())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("name",t.showPassword?"eye-off":"eye")}}function F(r,g){1&r&&(e.j41(0,"ion-note",40),e.EFF(1," Password must be at least 8 characters, include uppercase, lowercase, and a special character. "),e.k0s())}function T(r,g){if(1&r){const t=e.RV6();e.j41(0,"ion-icon",46),e.bIt("click",function(){m.eBV(t);const n=e.XpG();return m.Njj(n.toggleConfirmVisibility())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("name",t.showConfirm?"eye-off":"eye")}}function N(r,g){1&r&&(e.j41(0,"ion-note",40),e.EFF(1," Passwords do not match. "),e.k0s())}function D(r,g){if(1&r&&(e.j41(0,"ion-thumbnail",47),e.nrm(1,"img",48),e.k0s()),2&r){const t=e.XpG();e.R7$(),e.Y8G("src",t.photo,e.B4B)}}let v=(()=>{class r{constructor(t,a,n){this.registrationService=t,this.router=a,this.toastCtrl=n,this.firstName="",this.middleName="",this.lastName="",this.dob="",this.gender="",this.civilStatus="",this.contact="",this.purok="",this.barangay="",this.city="",this.province="",this.postalCode="",this.password="",this.confirmPassword="",this.showPassword=!1,this.showConfirm=!1,this.passwordError=!1,this.confirmError=!1,this.passwordFocused=!1,this.confirmFocused=!1,this.photo=null,this.maxDate="",this.isUnderage=!1,this.calculatedAge=0,this.dobSelected=!1,this.nameErrors={},this.purokOptions=["Purok Mangga","Purok Tambis","Purok Lubi","Purok Tinago","Purok Tabok","Purok Tagaytay","Purok Sapa","Purok Centro"]}ngOnInit(){this.setMaxDOB()}setMaxDOB(){const t=new Date;t.setFullYear(t.getFullYear()-18),this.maxDate=t.toISOString().split("T")[0]}checkAge(t){const a=Array.isArray(t)?t[0]:t;if(!a)return;const n=new Date,i=new Date(a);let o=n.getFullYear()-i.getFullYear();const _=n.getMonth()-i.getMonth();(_<0||0===_&&n.getDate()<i.getDate())&&o--,this.calculatedAge=o,this.isUnderage=o<18,this.dobSelected=!0,this.isUnderage&&this.presentToast("\u{1f6ab} You must be at least 18 years old.","warning")}togglePasswordVisibility(){this.showPassword=!this.showPassword}toggleConfirmVisibility(){this.showConfirm=!this.showConfirm}validatePassword(){const t=/[A-Z]/.test(this.password),a=/[a-z]/.test(this.password),n=/[\W_]/.test(this.password);this.passwordError=!(t&&a&&n&&this.password.length>=8)}autoUppercaseLive(t,a){const n=t.target,i=n.selectionStart,_=n.value.replace(/[^a-zA-Z\xf1\xd1\s'-]/g,"").toUpperCase();this[a]=_,setTimeout(()=>{n.setSelectionRange(i,i)})}validateName(t){const n=this[t].trim();this.nameErrors[t]=!n||/^[\s'-]+$/.test(n)?"Name must not be empty or contain only special characters.":/^[A-Za-z\xd1\xf1\s'-]+$/.test(n)?"":"Only letters, spaces, hyphens, and apostrophes are allowed."}preventPaste(t){t.preventDefault()}register(){var t=this;return(0,d.A)(function*(){t.validatePassword(),t.confirmError=t.password!==t.confirmPassword;const a=[];if(t.firstName||a.push("First Name"),t.lastName||a.push("Last Name"),t.contact||a.push("Contact Number"),t.gender||a.push("Gender"),t.dob||a.push("Date of Birth"),t.password||a.push("Password"),t.confirmPassword||a.push("Confirm Password"),t.purok||a.push("Purok"),a.length>0){const u=`\u26a0\ufe0f Missing: ${a.join(", ")}`;return void(yield t.presentToast(u,"warning"))}if(t.isUnderage)return void(yield t.presentToast("\u{1f6ab} You must be at least 18 years old to register.","danger"));if(t.passwordError||t.confirmError)return void(yield t.presentToast("\u274c Please fix password errors.","danger"));if(![t.firstName,t.lastName].every(u=>{const c=u.trim();return c&&/^[A-Za-z\xd1\xf1\s'-]+$/.test(c)}))return void(yield t.presentToast("\u274c Names must only contain letters, spaces, hyphens, or apostrophes.","danger"));if(!/^[9]\d{9}$/.test(t.contact))return void(yield t.presentToast("\u26a0\ufe0f Enter a valid 10-digit mobile number (starts with 9)","warning"));const o=function i(u){const c=u.trim().replace(/\D/g,"");return c.startsWith("0")?"+63"+c.slice(1):c.startsWith("9")&&10===c.length?"+63"+c:c}(t.contact),_=yield t.registrationService.isDuplicateContact(o),j=yield t.registrationService.isDuplicateName(t.firstName,t.middleName,t.lastName);if(_||j)return void(yield t.presentToast("\u26a0\ufe0f Duplicate record found.","danger"));const M={firstName:t.firstName.trim(),middleName:t.middleName.trim(),lastName:t.lastName.trim(),dob:t.dob,gender:t.gender,civilStatus:t.civilStatus,contact:o,purok:t.purok,barangay:t.barangay,city:t.city,province:t.province,postalCode:t.postalCode,password:t.password,photo:t.photo,role:"resident"};yield t.registrationService.saveOfflineRegistration(M),yield t.presentToast("\u2705 Registered successfully!","success"),console.log("\u{1f4e5} Saving to SQLite:",M),t.clearForm(),t.router.navigate(["/login"])})()}takePhoto(){var t=this;return(0,d.A)(function*(){try{const a=yield f.i7.getPhoto({quality:80,allowEditing:!1,resultType:f.LK.DataUrl,source:f.ru.Camera});t.photo=a.dataUrl||null}catch(a){yield t.presentToast("\u274c Failed to take photo.","danger"),console.error(a)}})()}clearForm(){this.firstName="",this.middleName="",this.lastName="",this.dob="",this.gender="",this.civilStatus="",this.contact="",this.purok="",this.barangay="",this.city="",this.province="",this.postalCode="",this.password="",this.confirmPassword="",this.photo=null,this.passwordError=!1,this.confirmError=!1,this.showPassword=!1,this.showConfirm=!1,this.isUnderage=!1,this.calculatedAge=0,this.dobSelected=!1,this.nameErrors={}}goToLogin(){this.router.navigate(["/login"])}presentToast(t,a){var n=this;return(0,d.A)(function*(){yield(yield n.toastCtrl.create({message:t,duration:2500,color:a,position:"top"})).present()})()}testView(){var t=this;return(0,d.A)(function*(){const a=yield t.registrationService.getAllRegistrations();console.log("\u{1f4c4} All registrations:",a)})()}static#e=this.\u0275fac=function(a){return new(a||r)(e.rXU(C.f),e.rXU(b.Ix),e.rXU(s.K_))};static#n=this.\u0275cmp=e.VBU({type:r,selectors:[["app-registration"]],decls:86,vars:31,consts:[[3,"translucent"],[1,"registration-content","ion-padding",3,"fullscreen"],["label","First Name *","label-placement","floating","fill","outline","autocomplete","given-name","required","",3,"ngModelChange","ionInput","blur","ngModel"],["color","danger","class","ion-padding-start",4,"ngIf"],["label","Middle Name","label-placement","floating","fill","outline","autocomplete","additional-name",3,"ngModelChange","ionInput","blur","ngModel"],["label","Last Name *","label-placement","floating","fill","outline","autocomplete","family-name","required","",3,"ngModelChange","ionInput","blur","ngModel"],[2,"color","red"],["datetime","dob"],["id","dob","presentation","date","show-default-buttons","true",3,"ngModelChange","ionChange","ngModel","max"],["color","medium",4,"ngIf"],["color","danger",4,"ngIf"],["interface","popover",3,"ngModelChange","ngModel"],["value","Male"],["value","Female"],["value","Other"],["value","Single"],["value","Married"],["value","Widowed"],[1,"phone-container"],["fill","outline","lines","none",1,"phone-box","prefix-box"],[1,"prefix-label"],["fill","outline","lines","none",1,"phone-box","input-box"],["label","Contact Number","label-placement","floating","type","tel","inputmode","numeric","maxlength","10","pattern","[0-9]*","placeholder","9123456789",3,"ngModelChange","ngModel"],["interface","popover","required","",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["label","Barangay","label-placement","floating","fill","outline",3,"ngModelChange","ionInput","ngModel"],["label","City / Municipality","label-placement","floating","fill","outline",3,"ngModelChange","ionInput","ngModel"],["label","Province","label-placement","floating","fill","outline",3,"ngModelChange","ionInput","ngModel"],["label","Postal Code","label-placement","floating","fill","outline","type","number",3,"ngModelChange","ngModel"],[1,"password-item"],["label","Password","label-placement","floating","fill","outline",1,"custom-password-input",3,"ngModelChange","focus","blur","type","ngModel"],["class","password-toggle-icon","slot","end",3,"name","click",4,"ngIf"],["label","Confirm Password","label-placement","floating","fill","outline",3,"ngModelChange","focus","blur","type","ngModel"],["slot","end",3,"name","click",4,"ngIf"],["expand","block","color","medium",1,"ion-margin-top",3,"click"],["slot","start","name","camera-outline"],["class","ion-margin-top ion-text-center",4,"ngIf"],["expand","block","color","primary",1,"ion-margin-top",3,"click","disabled"],[1,"ion-text-center","ion-margin-top"],[1,"link",3,"click"],["color","danger",1,"ion-padding-start"],["color","medium"],[1,"ion-padding-start"],["color","danger"],[3,"value"],["slot","end",1,"password-toggle-icon",3,"click","name"],["slot","end",3,"click","name"],[1,"ion-margin-top","ion-text-center"],["alt","User photo",3,"src"]],template:function(a,n){1&a&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Registration"),e.k0s()()(),e.j41(4,"ion-content",1)(5,"ion-list")(6,"ion-item")(7,"ion-input",2),e.mxI("ngModelChange",function(o){return e.DH7(n.firstName,o)||(n.firstName=o),o}),e.bIt("ionInput",function(o){return n.autoUppercaseLive(o,"firstName")})("blur",function(){return n.validateName("firstName")}),e.k0s()(),e.DNE(8,R,2,1,"ion-note",3),e.j41(9,"ion-item")(10,"ion-input",4),e.mxI("ngModelChange",function(o){return e.DH7(n.middleName,o)||(n.middleName=o),o}),e.bIt("ionInput",function(o){return n.autoUppercaseLive(o,"middleName")})("blur",function(){return n.validateName("middleName")}),e.k0s()(),e.DNE(11,O,2,1,"ion-note",3),e.j41(12,"ion-item")(13,"ion-input",5),e.mxI("ngModelChange",function(o){return e.DH7(n.lastName,o)||(n.lastName=o),o}),e.bIt("ionInput",function(o){return n.autoUppercaseLive(o,"lastName")})("blur",function(){return n.validateName("lastName")}),e.k0s()(),e.DNE(14,w,2,1,"ion-note",3),e.j41(15,"ion-item")(16,"ion-label"),e.EFF(17,"Date of Birth "),e.j41(18,"span",6),e.EFF(19,"*"),e.k0s()(),e.nrm(20,"ion-datetime-button",7),e.k0s(),e.j41(21,"ion-datetime",8),e.mxI("ngModelChange",function(o){return e.DH7(n.dob,o)||(n.dob=o),o}),e.bIt("ionChange",function(o){return n.checkAge(o.detail.value)}),e.k0s(),e.DNE(22,E,3,1,"ion-text",9)(23,k,3,0,"ion-text",10),e.j41(24,"ion-item")(25,"ion-label"),e.EFF(26,"Gender"),e.k0s(),e.j41(27,"ion-select",11),e.mxI("ngModelChange",function(o){return e.DH7(n.gender,o)||(n.gender=o),o}),e.j41(28,"ion-select-option",12),e.EFF(29,"Male"),e.k0s(),e.j41(30,"ion-select-option",13),e.EFF(31,"Female"),e.k0s(),e.j41(32,"ion-select-option",14),e.EFF(33,"Other"),e.k0s()()(),e.j41(34,"ion-item")(35,"ion-label"),e.EFF(36,"Civil Status"),e.k0s(),e.j41(37,"ion-select",11),e.mxI("ngModelChange",function(o){return e.DH7(n.civilStatus,o)||(n.civilStatus=o),o}),e.j41(38,"ion-select-option",15),e.EFF(39,"Single"),e.k0s(),e.j41(40,"ion-select-option",16),e.EFF(41,"Married"),e.k0s(),e.j41(42,"ion-select-option",17),e.EFF(43,"Widowed"),e.k0s()()(),e.j41(44,"div",18)(45,"ion-item",19)(46,"ion-label",20),e.EFF(47,"(+63)"),e.k0s()(),e.j41(48,"ion-item",21)(49,"ion-input",22),e.mxI("ngModelChange",function(o){return e.DH7(n.contact,o)||(n.contact=o),o}),e.k0s()()(),e.j41(50,"ion-item")(51,"ion-label"),e.EFF(52,"Purok "),e.j41(53,"span",6),e.EFF(54,"*"),e.k0s()(),e.j41(55,"ion-select",23),e.mxI("ngModelChange",function(o){return e.DH7(n.purok,o)||(n.purok=o),o}),e.DNE(56,y,2,2,"ion-select-option",24),e.k0s()(),e.j41(57,"ion-item")(58,"ion-input",25),e.mxI("ngModelChange",function(o){return e.DH7(n.barangay,o)||(n.barangay=o),o}),e.bIt("ionInput",function(o){return n.autoUppercaseLive(o,"barangay")}),e.k0s()(),e.j41(59,"ion-item")(60,"ion-input",26),e.mxI("ngModelChange",function(o){return e.DH7(n.city,o)||(n.city=o),o}),e.bIt("ionInput",function(o){return n.autoUppercaseLive(o,"city")}),e.k0s()(),e.j41(61,"ion-item")(62,"ion-input",27),e.mxI("ngModelChange",function(o){return e.DH7(n.province,o)||(n.province=o),o}),e.bIt("ionInput",function(o){return n.autoUppercaseLive(o,"province")}),e.k0s()(),e.j41(63,"ion-item")(64,"ion-input",28),e.mxI("ngModelChange",function(o){return e.DH7(n.postalCode,o)||(n.postalCode=o),o}),e.k0s()(),e.j41(65,"ion-item",29)(66,"ion-input",30),e.mxI("ngModelChange",function(o){return e.DH7(n.password,o)||(n.password=o),o}),e.bIt("focus",function(){return n.passwordFocused=!0})("blur",function(){return n.passwordFocused=!1}),e.k0s(),e.DNE(67,I,1,1,"ion-icon",31),e.k0s(),e.DNE(68,F,2,0,"ion-note",3),e.j41(69,"ion-item",29)(70,"ion-input",32),e.mxI("ngModelChange",function(o){return e.DH7(n.confirmPassword,o)||(n.confirmPassword=o),o}),e.bIt("focus",function(){return n.confirmFocused=!0})("blur",function(){return n.confirmFocused=!1}),e.k0s(),e.DNE(71,T,1,1,"ion-icon",33),e.k0s(),e.DNE(72,N,2,0,"ion-note",3),e.j41(73,"ion-button",34),e.bIt("click",function(){return n.takePhoto()}),e.nrm(74,"ion-icon",35),e.EFF(75," Take Photo "),e.j41(76,"span",6),e.EFF(77,"*"),e.k0s()(),e.DNE(78,D,2,1,"ion-thumbnail",36),e.j41(79,"ion-button",37),e.bIt("click",function(){return n.register()}),e.EFF(80," Register "),e.k0s()(),e.j41(81,"div",38)(82,"p"),e.EFF(83,"Already have an account? "),e.j41(84,"a",39),e.bIt("click",function(){return n.goToLogin()}),e.EFF(85,"Sign in"),e.k0s()()()()),2&a&&(e.Y8G("translucent",!0),e.R7$(4),e.Y8G("fullscreen",!0),e.R7$(3),e.R50("ngModel",n.firstName),e.R7$(),e.Y8G("ngIf",n.nameErrors.firstName),e.R7$(2),e.R50("ngModel",n.middleName),e.R7$(),e.Y8G("ngIf",n.nameErrors.middleName),e.R7$(2),e.R50("ngModel",n.lastName),e.R7$(),e.Y8G("ngIf",n.nameErrors.lastName),e.R7$(7),e.R50("ngModel",n.dob),e.Y8G("max",n.maxDate),e.R7$(),e.Y8G("ngIf",n.calculatedAge>0&&!n.isUnderage),e.R7$(),e.Y8G("ngIf",n.isUnderage),e.R7$(4),e.R50("ngModel",n.gender),e.R7$(10),e.R50("ngModel",n.civilStatus),e.R7$(12),e.R50("ngModel",n.contact),e.R7$(6),e.R50("ngModel",n.purok),e.R7$(),e.Y8G("ngForOf",n.purokOptions),e.R7$(2),e.R50("ngModel",n.barangay),e.R7$(2),e.R50("ngModel",n.city),e.R7$(2),e.R50("ngModel",n.province),e.R7$(2),e.R50("ngModel",n.postalCode),e.R7$(2),e.Y8G("type",n.showPassword?"text":"password"),e.R50("ngModel",n.password),e.R7$(),e.Y8G("ngIf",n.password||n.passwordFocused),e.R7$(),e.Y8G("ngIf",n.passwordError),e.R7$(2),e.Y8G("type",n.showConfirm?"text":"password"),e.R50("ngModel",n.confirmPassword),e.R7$(),e.Y8G("ngIf",n.confirmPassword||n.confirmFocused),e.R7$(),e.Y8G("ngIf",n.confirmError),e.R7$(6),e.Y8G("ngIf",n.photo),e.R7$(),e.Y8G("disabled",n.isUnderage))},dependencies:[s.bv,s.Jm,s.W9,s.A9,s.K4,s.eU,s.iq,s.$w,s.uz,s.he,s.nf,s.JI,s.Nm,s.Ip,s.IO,s.Zx,s.BC,s.ai,s.su,s.Je,s.Gw,p.YN,p.BC,p.YS,p.tU,p.R_,p.vS,h.MD,h.Sq,h.bT],styles:[".registration-content[_ngcontent-%COMP%]{--padding-bottom: 20px;background:#fff}.registration-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--border-color: #ccc;border-radius:8px;margin-bottom:12px;font-size:14px}.registration-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-weight:500}.registration-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%], .registration-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%], .registration-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-datetime[_ngcontent-%COMP%]{font-size:15px}.registration-content[_ngcontent-%COMP%]   .password-item[_ngcontent-%COMP%]{position:relative}.registration-content[_ngcontent-%COMP%]   .password-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .registration-content[_ngcontent-%COMP%]   .password-item[_ngcontent-%COMP%]   .toggle-icon[_ngcontent-%COMP%]{position:absolute;top:50%;right:16px;transform:translateY(-50%);font-size:20px;z-index:10;cursor:pointer;color:var(--ion-color-medium)}.registration-content[_ngcontent-%COMP%]   .phone-container[_ngcontent-%COMP%]{display:flex;gap:8px;max-width:320px;margin:0 auto 12px}.registration-content[_ngcontent-%COMP%]   .phone-container[_ngcontent-%COMP%]   .phone-box[_ngcontent-%COMP%], .registration-content[_ngcontent-%COMP%]   .phone-container[_ngcontent-%COMP%]   .prefix-box[_ngcontent-%COMP%], .registration-content[_ngcontent-%COMP%]   .phone-container[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]{border:1px solid #3e5b94;border-radius:8px;height:48px;display:flex;align-items:center;padding:0 12px;background:#fff}.registration-content[_ngcontent-%COMP%]   .phone-container[_ngcontent-%COMP%]   .prefix-box[_ngcontent-%COMP%]{flex:0 0 100px;justify-content:center}.registration-content[_ngcontent-%COMP%]   .phone-container[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]{flex:1}.registration-content[_ngcontent-%COMP%]   .phone-container[_ngcontent-%COMP%]   .prefix-label[_ngcontent-%COMP%]{font-size:16px;font-weight:500;color:#666}.registration-content[_ngcontent-%COMP%]   .phone-container[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{font-size:16px;text-align:center;width:100%}.registration-content[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin-top:14px;border-radius:8px}.registration-content[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]{max-width:120px;max-height:120px;margin:0 auto 12px;border-radius:10px;border:2px solid var(--ion-color-primary);display:block}.registration-content[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto;border-radius:8px}.registration-content[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{color:var(--ion-color-primary);font-weight:600;cursor:pointer;text-decoration:underline}"]})}return r})()}}]);